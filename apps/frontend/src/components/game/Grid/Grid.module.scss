@use 'sass:math';
@use '../../../styles/tokens/variables' as *;

.container {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 100%;
}



.gridWrapper {
  position: relative;
  width: 320px; 
  height: 320px; 
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 0 auto;
  perspective: 1000px; // Enable 3D space
  transition: transform var(--duration-normal), opacity var(--duration-normal);

  &.active {
    opacity: 1;
    transform: scale(1);
    pointer-events: auto;
  }

  &.inactive {
    opacity: 0;
    transform: scale(0.9) translateY(20px);
    pointer-events: none;
    position: absolute; // Remove from flow when inactive to overlay
  }
}

.grid {
  display: grid;
  grid-template-columns: repeat(8, 32px); // 8x8 Visuals
  grid-template-rows: repeat(8, 32px);
  gap: 1px;
  position: relative;
  transition: all var(--duration-normal);

  // BASE THEME (Default / Placement)
  background-color: var(--color-bg-deep);
  border: 2px solid var(--color-primary); // Restored and thickened
  box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);

  // FRIENDLY THEME (Defense)
  &.friendly {
    border-color: var(--color-friendly-accent);
    box-shadow: 0 0 20px rgba(34, 211, 238, 0.15);

    // Grid lines color mix
    background-color: color-mix(in srgb, var(--color-friendly-bg), var(--color-friendly-accent) 5%);
  }

  // ENEMY THEME (Attack)
  &.enemy {
    border-color: var(--color-enemy-accent);
    box-shadow: 0 0 20px rgba(245, 158, 11, 0.15);
    
    // Grid lines color mix
    background-color: color-mix(in srgb, var(--color-enemy-bg), var(--color-enemy-accent) 5%);
  }
}

.shipLayer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 10;
}

.ghostLayer {
  @extend .shipLayer;
  z-index: 20;
}

.ship {
  position: absolute;
  transition: all 0.2s ease-out;
  pointer-events: none;
}

.mine {
  position: absolute;
  width: 32px;
  height: 32px;
  display: flex;
  justify-content: center;
  align-items: center;
  pointer-events: none;
  z-index: 10;
  font-size: 20px;
}

.ghostParams {
  position: absolute;
  opacity: 0.6;
  pointer-events: none;
  transition: top 0.1s linear, left 0.1s linear;

  &--valid {
    filter: drop-shadow(0 0 4px var(--color-success));
    
    :global(svg) {
        path, rect {
             fill: color-mix(in srgb, var(--color-success), transparent 70%) !important;
             stroke: color-mix(in srgb, var(--color-success), transparent 20%) !important;
        }
    }
  }

  &--invalid {
    filter: drop-shadow(0 0 4px var(--color-danger));

     :global(svg) {
        path, rect {
             fill: color-mix(in srgb, var(--color-danger), transparent 70%) !important;
             stroke: color-mix(in srgb, var(--color-danger), transparent 20%) !important;
        }
    }
  }
}


